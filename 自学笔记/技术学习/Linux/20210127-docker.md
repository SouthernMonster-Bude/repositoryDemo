
### 一、安装Docker

```shell
# 1、yum 包更新到最新 
yum update
# 2、安装需要的软件包， yum-util 提供yum-config-manager功能，另外两个是devicemapper驱动依赖的 
yum install -y yum-utils device-mapper-persistent-data lvm2
# 3、 设置yum源
yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
# 4、 安装docker，出现输入的界面都按 y 
yum install -y docker-ce
# 5、 查看docker版本，验证是否验证成功
docker -v

```
### 二、配置镜像加速器
阿里云镜像加速地址通过登录阿里云获取，进入主页控制台，搜索容器镜像服务，将linux对应的命令复制并在linux中执行
```shell
sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json <<-'EOF'
{
  "registry-mirrors": ["https://9qu0e9fj.mirror.aliyuncs.com"]
}
EOF
sudo systemctl daemon-reload
sudo systemctl restart docker
```
也可以将镜像地址修改为中科大的docker镜像地址

docker
官方网址
hub.docker.com

### 三、docker命令
#### 服务相关命令
```shell
# 启动docker
systemctl start docker
# 查看状态
systemctl status docker
# 停止
systemctl stop docker
# 重启
systemctl restart docker
# 开机自启
systemctl enable docker
```
#### 镜像命令
```shell
# 查看镜像
docker images #查看本地
docker images -q #查看所有镜像id
# 搜索镜像
docker search imageName
# 拉取镜像
docker pull imageName[:versionNum]
# 删除镜像
docker rmi IMAGE_ID
docker rmi imageName:versionNum
# 全部删除
docker rmi `docker images -q`

```

#### 容器相关的命令

```shell
# 查看容器
docker ps # 正在运行的容器
docker ps -a # 查看所有容器包括已经停止的
docker ps -aq # 查看所有容器id
# 创建容器
docker run 参数
 docker run -i -d --name=mysql5.7002 mysql:5.7
 docker run -i -t --name=mysql5.7002 mysql:5.7 /bin/bash

# >参数说明
#     -i 保持容器运行，通常和-t一起使用，-it创建之后自动进入容器，退出之后容器自动关闭
#     -t 为容器重新分配一个为输入终端
#     -d 以后台程序模式运行容器，创建一个容器在后台运行，之后需要使用docker exec 进入容器，退出也不会关闭容器
#     --name 为创建的容器命名
# 进入容器
docker exec 容器名称
# 启动容器
docker start 容器名称
# 停止容器
docker stop 容器名称
# 删除容器
docker rm 容器名称
docker rmi `docker ps -aq`
# 查看容器信息
docker inspect 容器名称
```


### docker 数据卷

#### 概念
>数据卷是宿主机中的一个目录或者文件
>容器目录和数据卷目录绑定之后，文件是同步的
>一个数据卷可以被多个容器同时挂载
>一个容器也可以挂载多个数据卷

作用：容器数据持久化，外部机器和容器间接通信，容器之间交换数据

#### 配置数据卷
docker run ... -v 宿主机的目录:容器目录
docker run -it --name=c1 -v /root/data:/root/data_container centos:7 /bin/bash
目录必须是绝对目录
目录不存在会自动创建
可以挂载多个目录

#### 数据卷容器
多容器进行数据交换
可以多个容器挂载同一目录
也可以使用数据卷容器
##### 配置数据卷容器
1. 创建启动c3数据卷容器 使用-v 参数设置数据卷
docker run -it --name=c3 -v /volume centos:7 /bin/bash
docker 会自动创建一个宿主机目录和c3的这个目录对应
通过docker inspect c3 在mount 信息项中可以看到具体挂载的信息
2. 创建启动c1,c2使用--volumes-from参数设置数据卷
docker run -it --name c1 --volumes-from c3 centos:7 /bin/bash
docker run -it --name c2 --volumes-from c3 centos:7 /bin/bash
